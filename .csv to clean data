import pandas as pd
from collections import defaultdict
import gradio as gr

def file_return(file):
    df = pd.read_csv(file.name)
    col5 = df.iloc[:, 5].tolist()
    col7 = df.iloc[:, 7].tolist()
    
    col7 = [i.replace("Test Passes for Participant: ", "") for i in col7]
    col5 = [i.replace(i, '''[xln url="'''+ i + '''"]Link[/xln]''') for i in col5]
    
    result = defaultdict(list)

    for k, v in zip(col7, col5):
        result[k].append(v)

    output_final = ["Nume\tNumar Teme Necorectate\tLinkuri"]
    for k, v in result.items():
        output_final.append(f"{k} are {len(v)} teme necorectate: {' '.join(v)} ")
    return "\n".join(output_final)

      

iface = gr.Interface(
    fn=file_return,
    inputs=gr.File(file_types=[".csv"]),
    outputs=gr.Textbox(lines=50)
)

iface.launch()
